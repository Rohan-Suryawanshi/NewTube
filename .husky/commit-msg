#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Enforce a basic conventional commit format for commit messages.
# Allowed types: feat, fix, chore, docs, style, refactor, perf, test, build, ci, revert
commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")
regex='^(feat|fix|chore|docs|style|refactor|perf|test|build|ci|revert)(\(.+\))?: .{1,}'

if ! echo "$commit_msg" | grep -Eq "$regex"; then
  echo "\nCommit message validation failed."
  echo "Use conventional commits, e.g. 'feat(auth): add login' or 'fix: correct typo'"
  exit 1
fi
